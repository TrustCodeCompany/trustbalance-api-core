#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîç Ejecutando validaciones pre-commit..."

# Validaci√≥n de ESLint
echo "Validando c√≥digo con ESLint..."
npm run lint || {
  echo "‚ùå Error: Fallo en la validaci√≥n de ESLint. Corrige los problemas encontrados."
  echo "Ejecuta 'npm run lint' para ver los detalles y corregirlos."
  exit 1
}
echo "‚úÖ ESLint validado con √©xito."

# Validaci√≥n de Prettier
echo "Validando formato con Prettier..."
npm run prettier -- --check || {
  echo "‚ùå Error: Fallo en la validaci√≥n de Prettier. El c√≥digo no cumple con el formato."
  echo "Ejecuta 'npm run prettier -- --write' para aplicar los cambios autom√°ticos."
  exit 1
}
echo "‚úÖ Prettier validado con √©xito."

# Validaci√≥n de pruebas Jest
echo "Ejecutando pruebas con Jest..."
npm run test || {
  echo "‚ùå Error: Las pruebas fallaron. Corrige los fallos antes de continuar."
  echo "Ejecuta 'npm run test' para ver los detalles."
  exit 1
}
echo "‚úÖ Pruebas ejecutadas con √©xito."

echo "Validando cobertura con Jest..."
npm run test:cov || {
  echo "‚ùå Error: La cobertura no cumple con los requisitos m√≠nimos."
  echo "Ejecuta 'npm run test:cov' para ver los detalles."
  exit 1
}
echo "‚úÖ Cobertura validada con √©xito."

echo "‚úÖ Todas las validaciones pre-commit pasaron. Ahora se validar√° el mensaje de commit..."
